Проектирование БД


Сущности в БД
1. users
    1.1 Атрибуты:
        users_id - PK SERIAL
        uuid - UUID not null
        username - unique not null not modified
        email - unique not null modified
        password_hash - хешированных пароль пользователя, нужен для проверки входа к аккаунт. not null
        date_joined - дата и время регистрации. datetime current_timestamp
        last_login - время последнего входа в аккаунт. Нужен для того, чтобы отслеживать активен пользователь или нет.
        is_active - Булево значение, которое обозначает активен ли пользователь в системе или нет. default=True

    1.2 Связи:
        Пользователи - Профиль: Один-ко-одному (у одного пользователя только один профиль)
        Пользователи - Роли: Многие-ко-многим (у одного пользователя может быть много ролей, у ролей можеть быть много пользователей)

2. profile
    2.1 Атрибуты:
        profile_id - PK SERIAL
        name - Имя пользователя (Опционально)
        surname - Фамилия пользователя (Опционально)
        gender - Пол пользователя default=not definied
        date_of_birth - Дата рождения пользователя (Опционально)
        avatar_url - Ссылка на аватар пользователя (Опционально). Если у пользователя отсутствует аватар, то будет использоваться генерация identicon на основе username
        created_at - дата создания профиля в базе данных current_timestamp
        updated_at - время обновления профиля current_timestamp

    2.2 Связи
        Профиль - Пользователи: Один-ко-одному (у одного профиля только один пользователь)
        Профиль - Страна: Один-ко-многим (у одного профиля может быть только одна выбранная страна, у одной страны много пользователей) default=international
        Профиль - Звание (Rank): Один-ко-многим (у одного пользователя одно звание (его может и не быть), у однго звания много пользователей) default=None

3. countries
    3.1 Атрибуты:
        country_id - PK SERIAL
        name - название страны unique not null
        code - код страны (ISO 2-ух буквенное обозначение). unique not null
        description - описание для страны (Опционально)
        created_at - дата создания страны в базе данных current_timestamp
        updated_at - время обновления страны current_timestamp
    3.2 Связи:
        Страна - Профиль: Многие-ко-одному (у одной страны много пользователей, у одного пользователя одна страна)

4. ranks
    4.1 Атрибуты:
        rank_id - PK SERIAL
        name - название звания unique not null
        abbreviation - аббревиатура звания max_length=3 unique not null
        description - описание для звания (Опционально)
        created_at - время создания звания в базе данных current_timestamp
        updated_at - время обновления звания в базе данных current_timestamp

    4.2 Связи:
        Ранк - Профиль: Многие-ко-одному (у одного звания много пользователей, у пользователя одно звание или отсутствует)

5. roles
    5.1 Атрибуты:
        role_id - PK SERIAL
        name - наименование роли unique not null
        description - описание роли (Опционально)
        created_at - время создания роли в базе данных current_timestamp
        updated_at - время обновления роли в базе данных current_timestamp
    
    5.2 Связи:
        Роли - Пользователи: Многие-ко-многим (у одной роли много пользователей, у одного пользователя может быть много ролей)
        Роли - Привилегии: Многие-ко-многим (у одной роли может быть много привилегий, у привилегий много ролей)
    
    5.3 Роли
        5.3.1 Игрок
        5.3.2 Гость
        5.3.3 Администратор
        5.3.4 Модератор
        5.3.5 Система AI

6. privileges
    6.1 Атрибуты:
        privilege_id - PK SERIAL
        name - наименование привилегии
        description - описание привилегии (Опционально)
        created_at - время создания привилегии в базе данных current_timestamp
        updated_at - время обновления привилегии в базе данных current_timestamp
    
    6.2 Связи:
        Привилегии - Роли: Многие-ко-многим(у одной привилегии может быть много ролей, у одной роли много привилегий)
    
    6.3 Привилегии
        6.3.1 Что могут делать Игроки?
            6.3.1.1 Играть шахматные партии против других пользователей с привилегиями "Игрок" или "Система AI". У них будет возможность выбрать участвовать ли в рейтинговых или нерейтинговых играх.
            6.3.1.2 Они могут сохранять отдельные партии и делиться с другими людьми.
            6.3.1.3 Просматривать партии других игроков или партии со своим участием, а также против "Системы AI" (только свои партии против AI).
            6.3.1.4 Анализировать партии с помощью игрового движка (stockfish).
            6.3.1.5 Заводить дружбу с другими реальными пользователями.
            6.3.1.6 Участвовать в турнирах, в которых смогут принять участия (на турнирах будут ограничения, например по рейтингу или по званию).
            6.3.1.7 Смотреть трансляции игр в реальном времени (будто игра в турнире, игра двух реальных пользователей или игры топ-игроков).
            6.3.1.8 Иметь свой профиль. Просматривать его, иметь статистику по играм в разных форматам игр (пуля, рапид, блиц и т.д.), вносить корректировки (поменять имя, возраст и т.д.), также они имеют доступ к просмотру других пользователей.
            6.3.1.9 Будут иметь возможность выбрать тему доски или фигур.
            6.3.1.10 Комментировать партии и давать обратную связь, где это возможно.

        6.3.2 Что могут делать Гости?
            6.3.2.1 Они могут принимать участия в нерейтинговых играх, но играть они смогуть только с людьми, которые также находятся в статусе "Гости".
            6.3.2.2 Смотреть трансляции игр в реальном времени (будто игра в турнире, игра двух реальных пользователей или игры топ-игроков).
            6.3.2.3 Анализировать партии с помощью игрового движка (stockfish) (с ограничениями по количеству анализов, для получения полного доступа будет предложено зарегистрироваться)

        6.3.3 Что могут делать Администраторы?
            6.3.3.1 Все привилегии, которыми наделен "Игрок" и "Модератор"
            6.3.3.2 Может модифицировать профиль игрока во избежании нецензурной лексики, расистских высказываний и т.д.
            6.3.3.3 Может ограничивать игроков, которые нарушают пользовательское соглашение или которые были замечены в использовании читов (шахматного движка во время своих партий), в дальнейшем эти пользователи могут принимать участия в играх только с пользователями, которые также были замечены в использовании читов или нарушении пользовательских соглашений.
            6.3.3.4 Назначать роли и привилегии других пользователям.
            6.3.3.5 Изменять статистику игроков (например выиграл с использованием читов, ему запретили играть и вычли нечестную победу и т.д.).
            6.3.3.6 Отправлять сообщения от стороны приложения, чтобы тот исправил какие-то свои действия.
            6.3.3.7 Менять статус пользователя с активного на неактивный

        6.3.4 Что могут делать Модераторы?
            6.3.4.1 Все привилегии, которыми наделен "Игрок".
            6.3.4.2 Удалять некорректные сообщения в чатах.
            6.3.4.3 Отправление заявок "Администраторам", если обнаружена ошибка или нарушения, которые они не могут исправить самостоятельно.
            6.3.4.4 Ограничивать пользователей на общения в чатах. (на временной или постоянной основе.)

        6.3.5 Что может делать Система AI?
            6.3.5.1 Может иметь разный уровень сложности
            6.3.5.2 Играть с реальными пользователями
